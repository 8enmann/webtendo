<!DOCTYPE html>
<html>
  <head>
    <title>Webtendo</title>

    <link rel="stylesheet" href="/css/main.css" />
    <link rel="stylesheet" href="/css/client.css" />
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
  </head>
  <body>
    <div class="ctrl-left touch-region" data-buttonvalue="stick">
      <div id="joystick">
        <div id="stick"></div>
      </div>
    </div>
    <div id="buttonBox">
      <button data-buttonvalue="a" class="a touch-region">A</button>
      <button data-buttonvalue="b" class="b touch-region">B</button>
    </div>
    <div id="latency">Connecting...</div>
    <script src="/socket.io/socket.io.js"></script>
    <script src="scripts/webrtc-adapter/out/adapter.js"></script>
    <script src="js/client.js"></script>
    <script src="js/joystick.js"></script>
    <script>
     (function () {
       // Takes a moment for WebViewBridge to be ready, so setTimeout.
       setTimeout(() => {
       if (WebViewBridge) {
         WebViewBridge.onMessage = function (stringifiedMessage) {
           if (onMessageReceived) {
             onMessageReceived(JSON.parse(stringifiedMessage));
           }
         };
         sendToHost = function(message) {
           WebViewBridge.send(JSON.stringify(message));
         };
       }
       }, 500);
     }())
     var onMessageReceived = function(x) {
       // TODO: do something with message from host.
       console.log(x);
     }
     var onConnected = function(id) {
       console.log(id, 'connected');
       sendToHost({hello: 'host'});
     }

    </script>
  </body>
</html>
